# Initialize lists to store parent-child relationship data
parents = []
attributes_of_parents = []
children = []
attributes_of_children = []
weights = []

# Iterate over each row in the DataFrame
for index, row in df.iterrows():
    # Iterate over level columns
    for i in range(0, len(row), 3):
        # Get the parent and child information
        parent_col = f"level{i:03d}"
        parent_attr_col = f"level{i:03d}_Desc"
        child_col = f"level{i+1:03d}"
        child_attr_col = f"level{i+1:03d}_Desc"
        weight_col = f"level{i+1:03d}_Weight"
        
        # Check if parent and child columns exist in the row
        if parent_col in row and child_col in row:
            # Append parent-child relationship data to lists
            parents.append(row[parent_col])
            attributes_of_parents.append(row[parent_attr_col])
            children.append(row[child_col])
            attributes_of_children.append(row[child_attr_col])
            weights.append(row[weight_col])

# Create the parent-child relationship DataFrame
relationship_df = pd.DataFrame({
    'Parent': parents,
    'Attribute_of_Parent': attributes_of_parents,
    'Child': children,
    'Attribute_of_Child': attributes_of_children,
    'Weight': weights
})

print("Parent-Child Relationship DataFrame:")
print(relationship_df)
