from TM1py import TM1Service
from collections import defaultdict

with TM1Service(address="your_tm1_server", user="username", password="password") as tm1:
    # Replace with your TM1 server details
    # ...

    dimension_name = "your_dimension_name"
    hierarchy_name = "your_hierarchy_name"

    hierarchy = tm1.dimensions.hierarchies.get(dimension_name, hierarchy_name)

    parent_child_data = defaultdict(list)

    for (parent, child), weight in hierarchy.edges.items():
        parent_child_data[parent.name].append(child.name)

    data = []
    for parent, children in parent_child_data.items():
        for child in children:
            data.append({"Parent": parent, "Attribute of Parent": None, "Child": child, "Attribute of Child": None})

    df = pd.DataFrame(data)

# Use the DataFrame 'df' for further analysis
